Return-Path: <amelfeydi@gmail.com>
Delivered-To: contact@aymenrachdi.xyz
Received: from mail.aymenrachdi.xyz
	by mail.aymenrachdi.xyz with LMTP
	id yYT+CG8oPWTYNAAAYytROg
	(envelope-from <amelfeydi@gmail.com>)
	for <contact@aymenrachdi.xyz>; Mon, 17 Apr 2023 07:07:27 -0400
Received: from localhost (localhost [127.0.0.1])
	by mail.aymenrachdi.xyz (Postfix) with ESMTP id 19A17A6717
	for <contact@aymenrachdi.xyz>; Mon, 17 Apr 2023 07:07:27 -0400 (EDT)
X-Virus-Scanned: Yes
Received-SPF: Pass (mailfrom) identity=mailfrom; client-ip=209.85.214.169; helo=mail-pl1-f169.google.com; envelope-from=amelfeydi@gmail.com; receiver=<UNKNOWN> 
Authentication-Results: mail.aymenrachdi.xyz; dmarc=pass (p=none dis=none) header.from=gmail.com
Authentication-Results: mail.aymenrachdi.xyz;
	dkim=pass (2048-bit key; unprotected) header.d=gmail.com header.i=@gmail.com header.a=rsa-sha256 header.s=20221208 header.b=o1hk/nXa;
	dkim-atps=neutral
Authentication-Results: mail.aymenrachdi.xyz; dmarc=pass (p=none dis=none) header.from=gmail.com
Received: from mail-pl1-f169.google.com (mail-pl1-f169.google.com [209.85.214.169])
	by mail.aymenrachdi.xyz (Postfix) with ESMTPS id 790EDA6714
	for <contact@aymenrachdi.xyz>; Mon, 17 Apr 2023 07:07:25 -0400 (EDT)
Received: by mail-pl1-f169.google.com with SMTP id kh6so23636762plb.0
        for <contact@aymenrachdi.xyz>; Mon, 17 Apr 2023 04:07:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20221208; t=1681729637; x=1684321637;
        h=to:subject:message-id:date:from:mime-version:from:to:cc:subject
         :date:message-id:reply-to;
        bh=bEqbY5UhFDHHC4xRrpoyGbhcXo9H63PsbHqN65+YGXo=;
        b=o1hk/nXa/rbTuXiNgAMDvPJ1ASFj9e6NUxKiGnNE4Kx9lAxjAoPMTkVp8t/7BnsqF9
         +B6E98/vej/Hhg4mE2pK9/yjpF8Qo2/2VDlDZE9BatoMqvOAhlFpVPSau+DdTlVrsjNK
         TBecAmSA9ERLmfGIk5VUWKxghQFM3w65z79l2/KOzMj08K6SNJgWKxCq5nONyBBDImD8
         q4PEcJiimmokYlEKd+/YV6IM1d+kh7+U3cnvMudPBggcUeNOoxF6w7gNHld466EqCwiM
         tB65L+/HnOCZusbHtgdAy3+tcML2Q7nKkGWjjyhAdHROIahNLAeayngu4o600HMeies7
         9b1Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20221208; t=1681729637; x=1684321637;
        h=to:subject:message-id:date:from:mime-version:x-gm-message-state
         :from:to:cc:subject:date:message-id:reply-to;
        bh=bEqbY5UhFDHHC4xRrpoyGbhcXo9H63PsbHqN65+YGXo=;
        b=Bdl0catkhHEReIbCiJMk3ttkVOfRprVd8ujTmN9JlzCnXJIP0JKkbv5lbgG8QfAigh
         SguZTx8w7c3IA/NrXMGgaOD54afkHWqNAY6MB4LDjsPj4xa9BpnnxZROX/x1TxmZLAqB
         +hIylc1PSeFr3Wsq+9AMDFRw/LxUdyPDTs/iUiULki7lxXhfNwRGRY1a4OruAmvy6UQe
         GOD+IOs9waCJB5YHZe4NPTe50TC8dNlMF56nuCt8LZgbdFm5Zg2/s/rflxOq1q2UrKnX
         +Y7P7NfpQduo19Nvii9VX5FTXPv67h1wKXqMdBR9wvsatZg4Q+lC9GhctQFcFsoYy5Ja
         mLHg==
X-Gm-Message-State: AAQBX9dbGVM1+UvyeuD/nxgd2ZyluXkeZ9sRNKwbwtq2MH8jwwZdf/Gz
	i8cWGhMBWN6UAzAtJexnAGXmK052Tpo9EG/1Yvvv7xJPcdQ=
X-Google-Smtp-Source: AKy350bvorHow6iy2dQ9Bc2sWi9W4OBpSd3Jt+UUNINHVQKEIH8WYAvYl6tFvdHctJqcDdRB7ztc9GmOJleEsNvyOzM=
X-Received: by 2002:a17:902:bc47:b0:1a6:4434:9480 with SMTP id
 t7-20020a170902bc4700b001a644349480mr3283571plz.13.1681729637349; Mon, 17 Apr
 2023 04:07:17 -0700 (PDT)
MIME-Version: 1.0
From: amel faidi <amelfeydi@gmail.com>
Date: Mon, 17 Apr 2023 12:07:05 +0100
Message-ID: <CADcx6-CHWfeh2buk31icZp5z16h0eX_geR=_C-6hpt0y+=6q+Q@mail.gmail.com>
Subject: communication TCP IP
To: contact@aymenrachdi.xyz
Content-Type: multipart/mixed; boundary="000000000000a4958405f9863196"

--000000000000a4958405f9863196
Content-Type: multipart/alternative; boundary="000000000000a4958005f9863194"

--000000000000a4958005f9863194
Content-Type: text/plain; charset="UTF-8"



--000000000000a4958005f9863194
Content-Type: text/html; charset="UTF-8"

<div dir="ltr"><br></div>

--000000000000a4958005f9863194--
--000000000000a4958405f9863196
Content-Type: text/x-c++src; charset="US-ASCII"; name="server.cpp"
Content-Disposition: attachment; filename="server.cpp"
Content-Transfer-Encoding: base64
Content-ID: <f_lgkqe7av1>
X-Attachment-Id: f_lgkqe7av1

I2luY2x1ZGUgInNlcnZlci5oIgoKaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkKewoK
ICAgIC8vIGNyZWF0ZSBhIFRDUCBzb2NrZXQKICAgIGludCBzb2NrZmQgPSBzb2NrZXQoQUZfSU5F
VCwgU09DS19TVFJFQU0sIDApOwogICAgaWYgKHNvY2tmZCA8IDApCiAgICB7CiAgICAgICAgY2Vy
ciA8PCAiRXJyb3Igb3BlbmluZyBzb2NrZXQiIDw8IGVuZGw7CiAgICAgICAgcmV0dXJuIDE7CiAg
ICB9CgogICAgLy8gYWxsb3cgcmV1c2Ugb2YgdGhlIGFkZHJlc3MgYW5kIHBvcnQKICAgIGludCBy
ZXVzZSA9IDE7CiAgICBpZiAoc2V0c29ja29wdChzb2NrZmQsIFNPTF9TT0NLRVQsIFNPX1JFVVNF
QUREUiwgJnJldXNlLCBzaXplb2YocmV1c2UpKSA8IDApCiAgICB7CiAgICAgICAgY2VyciA8PCAi
RXJyb3Igc2V0dGluZyBzb2NrZXQgb3B0aW9ucyIgPDwgZW5kbDsKICAgICAgICByZXR1cm4gMTsK
ICAgIH0KCiAgICAvLyBiaW5kIHRoZSBzb2NrZXQgdG8gdGhlIGxvY2FsIGFkZHJlc3MgYW5kIHBv
cnQKICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBhZGRyOwogICAgYWRkci5zaW5fZmFtaWx5ID0gQUZf
SU5FVDsKICAgIGFkZHIuc2luX2FkZHIuc19hZGRyID0gSU5BRERSX0FOWTsKICAgIGFkZHIuc2lu
X3BvcnQgPSBodG9ucyhQT1JUKTsKICAgIGlmIChiaW5kKHNvY2tmZCwgKHN0cnVjdCBzb2NrYWRk
ciAqKSZhZGRyLCBzaXplb2YoYWRkcikpIDwgMCkKICAgIHsKICAgICAgICBjZXJyIDw8ICJFcnJv
ciBiaW5kaW5nIHNvY2tldCB0byBhZGRyZXNzIiA8PCBlbmRsOwogICAgICAgIHJldHVybiAxOwog
ICAgfQoKICAgIC8vIGxpc3RlbiBmb3IgaW5jb21pbmcgY29ubmVjdGlvbnMKICAgIGlmIChsaXN0
ZW4oc29ja2ZkLCA1KSA8IDApCiAgICB7CiAgICAgICAgY2VyciA8PCAiRXJyb3IgbGlzdGVuaW5n
IGZvciBjb25uZWN0aW9ucyIgPDwgZW5kbDsKICAgICAgICByZXR1cm4gMTsKICAgIH0KCiAgICBj
b3V0IDw8ICJTZXJ2ZXIgaXMgbGlzdGVuaW5nIG9uIHBvcnQgIiA8PCBQT1JUIDw8IGVuZGw7Cgog
ICAgLy8gYWNjZXB0IGEgbmV3IGNvbm5lY3Rpb24KICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBjbGll
bnRfYWRkcjsKICAgIHNvY2tsZW5fdCBjbGllbnRfbGVuID0gc2l6ZW9mKGNsaWVudF9hZGRyKTsK
ICAgIGludCBjbGllbnRfc29ja2ZkID0gYWNjZXB0KHNvY2tmZCwgKHN0cnVjdCBzb2NrYWRkciAq
KSZjbGllbnRfYWRkciwgJmNsaWVudF9sZW4pOwogICAgaWYgKGNsaWVudF9zb2NrZmQgPCAwKQog
ICAgewogICAgICAgIGNlcnIgPDwgIkVycm9yIGFjY2VwdGluZyBjb25uZWN0aW9uIiA8PCBlbmRs
OwogICAgICAgIHJldHVybiAxOwogICAgfQogICAgY291dCA8PCAiQ2xpZW50IGNvbm5lY3RlZCIg
PDwgZW5kbDsKICAgIGNvdXQgPDwgIkFjY2VwdGVkIGEgbmV3IGNvbm5lY3Rpb24gZnJvbSAiIDw8
IGluZXRfbnRvYShjbGllbnRfYWRkci5zaW5fYWRkcikgPDwgIjoiIDw8IG50b2hzKGNsaWVudF9h
ZGRyLnNpbl9wb3J0KSA8PCBlbmRsOwoKICAgIHBlcmZvcm1JbmZlcmVuY2UoY2xpZW50X3NvY2tm
ZCk7CiAgICBzZW5kX2RhdGFfZmlsZShjbGllbnRfc29ja2ZkLCAiLi9kYXRhL2RldGVjdGlvbnMu
Y3N2Iik7CgogICAgLy8gV2FpdCBmb3IgYW4gYWNrbm93bGVkZ2VtZW50IGZyb20gdGhlIGNsaWVu
dAogICAgY2hhciBhY2tfYnVmZmVyWzEwMjRdOwogICAgaW50IGFja19ieXRlc19yZWNlaXZlZCA9
IHJlY3YoY2xpZW50X3NvY2tmZCwgYWNrX2J1ZmZlciwgMTAyNCwgMCk7CiAgICBpZiAoYWNrX2J5
dGVzX3JlY2VpdmVkID4gMCkKICAgIHsKICAgICAgICBzdHJpbmcgYWNrX21lc3NhZ2UoYWNrX2J1
ZmZlciwgYWNrX2J5dGVzX3JlY2VpdmVkKTsKICAgICAgICBpZiAoYWNrX21lc3NhZ2UgPT0gIkFD
SyIpCiAgICAgICAgewogICAgICAgICAgICBjb3V0IDw8ICJSZWNlaXZlZCBhY2tub3dsZWRnZW1l
bnQgZnJvbSBjbGllbnQiIDw8IGVuZGw7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFJlY2VpdmUg
cmVxdWVzdCB0eXBlIGZyb20gY2xpZW50CiAgICBSZXF1ZXN0VHlwZSByZXF1ZXN0X3R5cGU7CiAg
ICBpbnQgcmVxdWVzdF90eXBlX3NpemUgPSByZWN2KGNsaWVudF9zb2NrZmQsICZyZXF1ZXN0X3R5
cGUsIHNpemVvZihyZXF1ZXN0X3R5cGUpLCAwKTsKICAgIGlmIChyZXF1ZXN0X3R5cGVfc2l6ZSA8
IDApCiAgICB7CiAgICAgICAgY2VyciA8PCAiRXJyb3IgcmVjZWl2aW5nIHJlcXVlc3QgdHlwZSBm
cm9tIGNsaWVudCIgPDwgZW5kbDsKICAgICAgICBjbG9zZShjbGllbnRfc29ja2ZkKTsKICAgICAg
ICByZXR1cm4gMTsKICAgIH0KCiAgICBzd2l0Y2ggKHJlcXVlc3RfdHlwZSkKICAgIHsKICAgIGNh
c2UgUmVxdWVzdFR5cGU6OkdFVF9EQVRBOgogICAgewogICAgICAgIC8vIHJlY2VpdmUgcmVxdWVz
dGVkIGRhdGEgdHlwZSBmcm9tIGNsaWVudAogICAgICAgIFJlcXVlc3RlZERhdGFUeXBlIHJlcXVl
c3RlZERhdGFfdHlwZTsKICAgICAgICBpZiAocmVjdihjbGllbnRfc29ja2ZkLCAmcmVxdWVzdGVk
RGF0YV90eXBlLCBzaXplb2YocmVxdWVzdGVkRGF0YV90eXBlKSwgMCkgPT0gLTEpCiAgICAgICAg
ewogICAgICAgICAgICBwZXJyb3IoIkVycm9yIHJlY2VpdmluZyByZXF1ZXN0ZWQgZGF0YSB0eXBl
Iik7CiAgICAgICAgICAgIGV4aXQoMSk7CiAgICAgICAgfQoKICAgICAgICBzd2l0Y2ggKHJlcXVl
c3RlZERhdGFfdHlwZSkKICAgICAgICB7CiAgICAgICAgY2FzZSBSZXF1ZXN0ZWREYXRhVHlwZTo6
R0VUX0ZJTEU6CiAgICAgICAgewogICAgICAgICAgICBzZW5kX2RhdGFfZmlsZShjbGllbnRfc29j
a2ZkLCAiLi9kYXRhL2RldGVjdGlvbnMuY3N2Iik7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAg
IH0KICAgICAgICBjYXNlIFJlcXVlc3RlZERhdGFUeXBlOjpHRVRfRlJBTUU6CiAgICAgICAgewog
ICAgICAgICAgICBzZW5kX3RpbWVzdGFtcChjbGllbnRfc29ja2ZkKTsKICAgICAgICAgICAgc2Vu
ZF9kZXRlY3Rpb25fZnJhbWVzKGNsaWVudF9zb2NrZmQpOwogICAgICAgICAgICAvL3NlbmRfZGF0
YV9maWxlKGNsaWVudF9zb2NrZmQsICIuL2RhdGEvZGV0ZWN0aW9ucy5jc3YiKTsKICAgICAgICAg
ICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgUmVxdWVzdGVkRGF0YVR5cGU6OkdFVF9M
T0dGSUxFOgogICAgICAgIHsKICAgICAgICAgICAgc2VuZF9kYXRhX2ZpbGUoY2xpZW50X3NvY2tm
ZCwgImxvZ0ZpbGVzL1N5c3RlbV9TdWJzeXN0ZW1fbG9nRmlsZS5sb2ciKTsKICAgICAgICAgICAg
YnJlYWs7CiAgICAgICAgfQogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgewogICAgICAgICAgICBj
ZXJyIDw8ICJFcnJvcjogVW5rbm93biByZXF1ZXN0ZWQgZGF0YSB0eXBlIiA8PCBlbmRsOwogICAg
ICAgICAgICBjbG9zZShjbGllbnRfc29ja2ZkKTsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAg
ICAgfQogICAgICAgIH0KICAgICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUmVxdWVzdFR5cGU6
OlNFTkRfQ09OVFJPTDoKICAgIHsKICAgICAgICAvLyByZWNlaXZlIHVwZGF0ZSB0eXBlIGZyb20g
Y2xpZW50CiAgICAgICAgU0VORF9DT05UUk9MVHlwZSBzZW5kX0NvbnRyb2x0eXBlOwogICAgICAg
IGlmIChyZWN2KGNsaWVudF9zb2NrZmQsICZzZW5kX0NvbnRyb2x0eXBlLCBzaXplb2Yoc2VuZF9D
b250cm9sdHlwZSksIDApID09IC0xKQogICAgICAgIHsKICAgICAgICAgICAgcGVycm9yKCJFcnJv
ciByZWNlaXZpbmcgdXBkYXRlIHR5cGUiKTsKICAgICAgICAgICAgZXhpdCgxKTsKICAgICAgICB9
CgogICAgICAgIGJvb2wgY29udHJvbF9zdWNjZXNzZnVsID0gZmFsc2U7CgogICAgICAgIHN3aXRj
aCAoc2VuZF9Db250cm9sdHlwZSkKICAgICAgICB7CiAgICAgICAgY2FzZSBTRU5EX0NPTlRST0xU
eXBlOjpDT05UUk9MX0NMT0NLOgogICAgICAgIHsKICAgICAgICAgICAgY29udHJvbF9zdWNjZXNz
ZnVsID0gcmVjZWl2ZUNvbmZGaWxlc1VwZGF0ZXMoIkNsb2NrLmluaSIsIGNsaWVudF9zb2NrZmQp
OwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSBTRU5EX0NPTlRST0xU
eXBlOjpDT05UUk9MX1BPV0VSOgogICAgICAgIHsKICAgICAgICAgICAgY29udHJvbF9zdWNjZXNz
ZnVsID0gcmVjZWl2ZUNvbmZGaWxlc1VwZGF0ZXMoIlBvd2VyLmluaSIsIGNsaWVudF9zb2NrZmQp
OwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSBTRU5EX0NPTlRST0xU
eXBlOjpDT05UUk9MX1RFTEVNRVRSWToKICAgICAgICB7CiAgICAgICAgICAgIGNvbnRyb2xfc3Vj
Y2Vzc2Z1bCA9IHJlY2VpdmVDb25mRmlsZXNVcGRhdGVzKCJUZWxlbWV0cnkuaW5pIiwgY2xpZW50
X3NvY2tmZCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIFNFTkRf
Q09OVFJPTFR5cGU6OkNPTlRST0xfU1lTX1NUQVRFOgogICAgICAgIHsKICAgICAgICAgICAgY29u
dHJvbF9zdWNjZXNzZnVsID0gcmVjZWl2ZUNvbmZGaWxlc1VwZGF0ZXMoIlN5c3RlbVN0YXRlLmlu
aSIsIGNsaWVudF9zb2NrZmQpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAg
Y2FzZSBTRU5EX0NPTlRST0xUeXBlOjpDT05UUk9MX0VvRjoKICAgICAgICB7CiAgICAgICAgICAg
IGNvbnRyb2xfc3VjY2Vzc2Z1bCA9IHJlY2VpdmVDb25mRmlsZXNVcGRhdGVzKCJFb0YuaW5pIiwg
Y2xpZW50X3NvY2tmZCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNl
IFNFTkRfQ09OVFJPTFR5cGU6OkNPTlRST0xfREVURUNUT1JTOgogICAgICAgIHsKICAgICAgICAg
ICAgY29udHJvbF9zdWNjZXNzZnVsID0gcmVjZWl2ZUNvbmZGaWxlc1VwZGF0ZXMoIlN1bnNwb3RE
ZXRlY3Rpb24uaW5pIiwgY2xpZW50X3NvY2tmZCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAg
IH0KICAgICAgICBkZWZhdWx0OgogICAgICAgIHsKICAgICAgICAgICAgY2VyciA8PCAiUmVjZWl2
ZWQgdW5rbm93biB1cGRhdGUgcmVxdWVzdCBmcm9tIGNsaWVudCIgPDwgZW5kbDsKICAgICAgICAg
ICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGNvbnRyb2xfc3VjY2Vz
c2Z1bCkKICAgICAgICB7CiAgICAgICAgICAgIGNvdXQgPDwgIkNvbnRyb2wgc2VudCBzdWNjZXNz
ZnVsbHkhICIgPDwgZW5kbDsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAg
ICAgICAgY2VyciA8PCAiRXJyb3IgdXBkYXRpbmcgY29uZmlnIiA8PCBlbmRsOwogICAgICAgIH0K
CiAgICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFJlcXVlc3RUeXBlOjpSZWdDT05UUk9MOgog
ICAgewogICAgICAgIC8vIHJlY2VpdmUgY29udHJvbCB0eXBlIGZyb20gY2xpZW50CiAgICAgICAg
UmVnQ29udHJvbFR5cGUgY29udHJvbF9yZWc7CiAgICAgICAgaWYgKHJlY3YoY2xpZW50X3NvY2tm
ZCwgJmNvbnRyb2xfcmVnLCBzaXplb2YoY29udHJvbF9yZWcpLCAwKSA9PSAtMSkKICAgICAgICB7
CiAgICAgICAgICAgIHBlcnJvcigiRXJyb3IgcmVjZWl2aW5nIGNvbnRyb2wgdHlwZSIpOwogICAg
ICAgICAgICBleGl0KDEpOwogICAgICAgIH0KICAgICAgICBib29sIGNvbnRyb2xfc3VjY2Vzc2Z1
bCA9IGZhbHNlOwoKICAgICAgICBzd2l0Y2ggKGNvbnRyb2xfcmVnKQogICAgICAgIHsKICAgICAg
ICBjYXNlIFJlZ0NvbnRyb2xUeXBlOjpSZWdDb250cm9sX0NMT0NLOgogICAgICAgIHsKICAgICAg
ICAgICAgQ29udHJvbFJlZ2lzdGVyc1VwZGF0ZShjbGllbnRfc29ja2ZkLCAiQ0xPQ0siKTsKICAg
ICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGNhc2UgUmVnQ29udHJvbFR5cGU6OlJl
Z0NvbnRyb2xfUE9XRVI6CiAgICAgICAgewogICAgICAgICAgICBDb250cm9sUmVnaXN0ZXJzVXBk
YXRlKGNsaWVudF9zb2NrZmQsICJQT1dFUiIpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9
CiAgICAgICAgY2FzZSBSZWdDb250cm9sVHlwZTo6UmVnQ29udHJvbF9DRToKICAgICAgICB7CiAg
ICAgICAgICAgIENvbnRyb2xSZWdpc3RlcnNVcGRhdGUoY2xpZW50X3NvY2tmZCwgIkVDIik7CiAg
ICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIFJlZ0NvbnRyb2xUeXBlOjpS
ZWdDb250cm9sX0xMQzoKICAgICAgICB7CiAgICAgICAgICAgIENvbnRyb2xSZWdpc3RlcnNVcGRh
dGUoY2xpZW50X3NvY2tmZCwgIkxMQyIpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAg
ICAgICAgZGVmYXVsdDoKICAgICAgICB7CiAgICAgICAgICAgIGNlcnIgPDwgIkVycm9yOiBVbmtu
b3duIGNvbnRyb2wgdHlwZSIgPDwgZW5kbDsKICAgICAgICAgICAgLy8gQ2xvc2UgY2xpZW50IGNv
bm5lY3Rpb24KICAgICAgICAgICAgY2xvc2UoY2xpZW50X3NvY2tmZCk7CiAgICAgICAgfQogICAg
ICAgIH0KICAgIH0KICAgIH0KICAgIC8vIENsb3NlIGNsaWVudCBjb25uZWN0aW9uCiAgICBjbG9z
ZShjbGllbnRfc29ja2ZkKTsKICAgIGNvdXQgPDwgIkNvbm5lY3Rpb24gd2l0aCAiIDw8IGluZXRf
bnRvYShjbGllbnRfYWRkci5zaW5fYWRkcikgPDwgIjoiIDw8IG50b2hzKGNsaWVudF9hZGRyLnNp
bl9wb3J0KSA8PCAiIGNsb3NlZCIgPDwgZW5kbDsKICAgIC8vIGNsb3NlIHRoZSBzZXJ2ZXIgc29j
a2V0CiAgICBjbG9zZShzb2NrZmQpOwoKICAgIHJldHVybiAwOwp9
--000000000000a4958405f9863196
Content-Type: text/x-c++src; charset="US-ASCII"; name="client.cpp"
Content-Disposition: attachment; filename="client.cpp"
Content-Transfer-Encoding: base64
Content-ID: <f_lgkqe7ae0>
X-Attachment-Id: f_lgkqe7ae0

I2luY2x1ZGUgImNsaWVudC5oIgojaW5jbHVkZSA8UUFwcGxpY2F0aW9uPgojaW5jbHVkZSA8UVdp
ZGdldD4KI2luY2x1ZGUgPFFWQm94TGF5b3V0PgojaW5jbHVkZSA8UVB1c2hCdXR0b24+CiNpbmNs
dWRlIDxRU2xpZGVyPgojaW5jbHVkZSA8UUxhYmVsPgojaW5jbHVkZSA8UXRDb3JlL1FEZWJ1Zz4K
I2luY2x1ZGUgPFFGaWxlPgojaW5jbHVkZSA8UVRhYmxlV2lkZ2V0SXRlbT4KCgppbnQgbWFpbihp
bnQgYXJnYywgY2hhciAqYXJndltdKQp7CiAgICBpZiAoYXJnYyAhPSAxKQogICAgewogICAgICAg
IGNlcnIgPDwgIlVzYWdlOiAiIDw8IGFyZ3ZbMF0gPDwgZW5kbDsKICAgICAgICByZXR1cm4gMTsK
ICAgIH0KCiAgICAvLyBjcmVhdGUgYSBUQ1Agc29ja2V0CiAgICBpbnQgc29ja2ZkID0gc29ja2V0
KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCAwKTsKICAgIGlmIChzb2NrZmQgPCAwKQogICAgewogICAg
ICAgIGNlcnIgPDwgIkVycm9yIG9wZW5pbmcgc29ja2V0IiA8PCBlbmRsOwogICAgICAgIHJldHVy
biAxOwogICAgfQoKICAgIC8vIGNvbm5lY3QgdG8gdGhlIHNlcnZlcgogICAgc3RydWN0IHNvY2th
ZGRyX2luIHNlcnZlcl9hZGRyOwogICAgc2VydmVyX2FkZHIuc2luX2ZhbWlseSA9IEFGX0lORVQ7
CiAgICBzZXJ2ZXJfYWRkci5zaW5fYWRkci5zX2FkZHIgPSBpbmV0X2FkZHIoU0VSVkVSX0FERFJF
U1MpOwogICAgc2VydmVyX2FkZHIuc2luX3BvcnQgPSBodG9ucyhQT1JUKTsKICAgIGlmIChjb25u
ZWN0KHNvY2tmZCwgKHN0cnVjdCBzb2NrYWRkciAqKSZzZXJ2ZXJfYWRkciwgc2l6ZW9mKHNlcnZl
cl9hZGRyKSkgPCAwKQogICAgewogICAgICAgIGNlcnIgPDwgIkVycm9yIGNvbm5lY3RpbmcgdG8g
c2VydmVyIiA8PCBlbmRsOwogICAgICAgIHJldHVybiAxOwogICAgfQogICAgLy8gcmVjZWl2ZSBk
YXRhIGZyb20gc2VydmVyCiAgICByZWNlaXZlX2RhdGFfZmlsZShzb2NrZmQsICJyZWNlaXZlZF9k
ZXRlY3Rpb25zLmNzdiIpOwoKICAgIC8vIHNlbmQgYWNrbm93bGVkZ2VtZW50IHRvIHNlcnZlcgog
ICAgY29uc3QgY2hhciAqYWNrID0gIkFja25vd2xlZGdlZCEiOwogICAgaWYgKHNlbmQoc29ja2Zk
LCBhY2ssIHN0cmxlbihhY2spLCAwKSA8IDApCiAgICB7CiAgICAgICAgc3RkOjpjZXJyIDw8ICJG
YWlsZWQgdG8gc2VuZCBhY2tub3dsZWRnZW1lbnQgdG8gc2VydmVyIiA8PCBzdGQ6OmVuZGw7CiAg
ICAgICAgY2xvc2Uoc29ja2ZkKTsKICAgICAgICByZXR1cm4gMTsKICAgIH0KICAgIHN0ZDo6Y291
dCA8PCAiU2VudCBhY2tub3dsZWRnZW1lbnQgdG8gc2VydmVyIiA8PCBzdGQ6OmVuZGw7CgogICAg
Ly8gU2VuZCByZXF1ZXN0IHR5cGUgdG8gc2VydmVyCgogICAgUmVxdWVzdFR5cGUgcmVxdWVzdF90
eXBlID0gUmVxdWVzdFR5cGU6OlVOS05PV05fUkVRVUVTVDsKICAgIFJlcXVlc3RlZERhdGFUeXBl
IHJlcXVlc3RlZERhdGFfdHlwZSA9IFJlcXVlc3RlZERhdGFUeXBlOjpVTktOT1dOX0RBVEE7CiAg
ICBTRU5EX0NPTlRST0xUeXBlIHNlbmRfQ29udHJvbHR5cGUgPSBTRU5EX0NPTlRST0xUeXBlOjpV
TktOT1dOX0NPTlRST0w7CiAgICBSZWdDb250cm9sVHlwZSBjb250cm9sX3JlZyA9IFJlZ0NvbnRy
b2xUeXBlIDo6VU5LTk9XTl9SZWdDb250cm9sOwoKICAgIFFBcHBsaWNhdGlvbiBhKGFyZ2MsIGFy
Z3YpOwoKICAgIC8vIENyZWF0ZSBhIG1haW4gd2luZG93IHdpZGdldAogICAgUVdpZGdldCAqbWFp
bldpbmRvdyA9IG5ldyBRV2lkZ2V0KCk7CiAgICBtYWluV2luZG93LT5zZXRGaXhlZFNpemUoNDAw
LCA4MDApOyAvLyBzZXQgYSBmaXhlZCBzaXplIGZvciB0aGUgd2luZG93CgogICAgLy8gQ3JlYXRl
IGEgdmVydGljYWwgbGF5b3V0IGZvciB0aGUgbWFpbiB3aW5kb3cgd2lkZ2V0CiAgICBRVkJveExh
eW91dCAqbGF5b3V0ID0gbmV3IFFWQm94TGF5b3V0KG1haW5XaW5kb3cpOwoKICAgIC8vIENyZWF0
ZSBhIHZlcnRpY2FsIGxheW91dCBmb3IgdGhlIGZpcnN0IG1haW4gYnV0dG9uIGFuZCBpdHMgc3Vi
LWJ1dHRvbnMKICAgIFFWQm94TGF5b3V0ICpsYXlvdXQxID0gbmV3IFFWQm94TGF5b3V0KCk7CiAg
ICBRUHVzaEJ1dHRvbiAqYnV0dG9uMSA9IG5ldyBRUHVzaEJ1dHRvbigiUmVxdWVzdCBkYXRhIiwg
bWFpbldpbmRvdyk7CiAgICBRUHVzaEJ1dHRvbiAqYnV0dG9uMV8xID0gbmV3IFFQdXNoQnV0dG9u
KCJGaWxlIiwgbWFpbldpbmRvdyk7CiAgICBRUHVzaEJ1dHRvbiAqYnV0dG9uMV8yID0gbmV3IFFQ
dXNoQnV0dG9uKCJMb2dGaWxlIiwgbWFpbldpbmRvdyk7CiAgICBRUHVzaEJ1dHRvbiAqYnV0dG9u
MV8zID0gbmV3IFFQdXNoQnV0dG9uKCJGcmFtZXMiLCBtYWluV2luZG93KTsKICAgIGxheW91dDEt
PmFkZFdpZGdldChidXR0b24xKTsKICAgIGxheW91dDEtPmFkZFdpZGdldChidXR0b24xXzEpOwog
ICAgbGF5b3V0MS0+YWRkV2lkZ2V0KGJ1dHRvbjFfMik7CiAgICBsYXlvdXQxLT5hZGRXaWRnZXQo
YnV0dG9uMV8zKTsKICAgIGxheW91dDEtPnNldFNwYWNpbmcoMCk7CiAgICBsYXlvdXQxLT5zZXRD
b250ZW50c01hcmdpbnMoMCwgMCwgMCwgMCk7CiAgICBidXR0b24xXzEtPmhpZGUoKTsKICAgIGJ1
dHRvbjFfMi0+aGlkZSgpOwogICAgYnV0dG9uMV8zLT5oaWRlKCk7CgogICAgLy8gQ29ubmVjdCB0
aGUgY2xpY2tlZCgpIHNpZ25hbCBvZiB0aGUgZmlyc3QgbWFpbiBidXR0b24gdG8gYSBjdXN0b20g
c2xvdCB0aGF0IHRvZ2dsZXMgdGhlIHZpc2liaWxpdHkgb2YgaXRzIHN1Yi1idXR0b25zCiAgICBR
T2JqZWN0Ojpjb25uZWN0KGJ1dHRvbjEsICZRUHVzaEJ1dHRvbjo6Y2xpY2tlZCwgWyZdKCkKICAg
ICAgICAgICAgICAgICAgICAgewogICAgICAgIHJlcXVlc3RfdHlwZSA9IFJlcXVlc3RUeXBlOjpH
RVRfREFUQTsKICAgICAgICAvLyBTZW5kIHJlcXVlc3QgdHlwZSB0byBzZXJ2ZXIKICAgICAgICBp
ZiAoc2VuZChzb2NrZmQsICZyZXF1ZXN0X3R5cGUsIHNpemVvZihyZXF1ZXN0X3R5cGUpLCAwKSA9
PSAtMSkKICAgICAgICB7CiAgICAgICAgICAgIHBlcnJvcigiRXJyb3Igc2VuZGluZyByZXF1ZXN0
IHR5cGUiKTsKICAgICAgICAgICAgZXhpdCgxKTsKICAgICAgICB9CiAgICAgICAgYnV0dG9uMV8x
LT5zZXRWaXNpYmxlKCFidXR0b24xXzEtPmlzVmlzaWJsZSgpKTsKICAgICAgICBidXR0b24xXzIt
PnNldFZpc2libGUoIWJ1dHRvbjFfMi0+aXNWaXNpYmxlKCkpOwogICAgICAgIGJ1dHRvbjFfMy0+
c2V0VmlzaWJsZSghYnV0dG9uMV8zLT5pc1Zpc2libGUoKSk7IH0pOwoKICAgIC8vIENvbm5lY3Qg
dGhlIGNsaWNrZWQoKSBzaWduYWwgb2YgYnV0dG9uMV8xIHRvIGEgY3VzdG9tIHNsb3QgdGhhdCBw
cmludHMgYSBtZXNzYWdlCiAgICBRT2JqZWN0Ojpjb25uZWN0KGJ1dHRvbjFfMSwgJlFQdXNoQnV0
dG9uOjpjbGlja2VkLCBbJl0oKQogICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICBy
ZXF1ZXN0ZWREYXRhX3R5cGUgPSAgUmVxdWVzdGVkRGF0YVR5cGU6OkdFVF9GSUxFOwogICAgICAg
IGlmIChzZW5kKHNvY2tmZCwgJnJlcXVlc3RlZERhdGFfdHlwZSwgc2l6ZW9mKHJlcXVlc3RlZERh
dGFfdHlwZSksIDApID09IC0xKQogICAgICAgIHsKICAgICAgICAgICAgcGVycm9yKCJFcnJvciBz
ZW5kaW5nIHJlcXVlc3RlZCBkYXRhIHR5cGUiKTsKICAgICAgICAgICAgZXhpdCgxKTsKICAgICAg
ICB9OwogICAgICAgIHJlY2VpdmVfZGF0YV9maWxlKHNvY2tmZCwgInJlcXVlc3RlZF9GaWxlLnR4
dCIpOyB9KTsKICAgIC8vIENvbm5lY3QgdGhlIGNsaWNrZWQoKSBzaWduYWwgb2YgYnV0dG9uMV8y
IHRvIGEgY3VzdG9tIHNsb3QgdGhhdCBwcmludHMgYSBtZXNzYWdlCiAgICBRT2JqZWN0Ojpjb25u
ZWN0KGJ1dHRvbjFfMiwgJlFQdXNoQnV0dG9uOjpjbGlja2VkLCBbJl0oKQogICAgICAgICAgICAg
ICAgICAgICB7cmVxdWVzdGVkRGF0YV90eXBlID0gUmVxdWVzdGVkRGF0YVR5cGU6OkdFVF9MT0dG
SUxFOyAKICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbmQoc29ja2ZkLCAmcmVxdWVzdGVkRGF0
YV90eXBlLCBzaXplb2YocmVxdWVzdGVkRGF0YV90eXBlKSwgMCkgPT0gLTEpCiAgICAgICAgICAg
ICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwZXJyb3IoIkVycm9yIHNlbmRpbmcg
cmVxdWVzdGVkIGRhdGEgdHlwZSIpOwogICAgICAgICAgICAgICAgICAgICAgICBleGl0KDEpOwog
ICAgICAgICAgICAgICAgICAgIH07CiAgICByZWNlaXZlX2RhdGFfZmlsZShzb2NrZmQsICJTeXN0
ZW1fU3Vic3lzdGVtX2xvZ0ZpbGUubG9nIik7IH0pOwogICAgLy8gQ29ubmVjdCB0aGUgY2xpY2tl
ZCgpIHNpZ25hbCBvZiBidXR0b24xXzMgdG8gYSBjdXN0b20gc2xvdCB0aGF0IHByaW50cyBhIG1l
c3NhZ2UKICAgIFFPYmplY3Q6OmNvbm5lY3QoYnV0dG9uMV8zLCAmUVB1c2hCdXR0b246OmNsaWNr
ZWQsIFsmXSgpCiAgICAgICAgICAgICAgICAgICAgIHtyZXF1ZXN0ZWREYXRhX3R5cGUgPSBSZXF1
ZXN0ZWREYXRhVHlwZTo6R0VUX0ZSQU1FOyAKICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbmQo
c29ja2ZkLCAmcmVxdWVzdGVkRGF0YV90eXBlLCBzaXplb2YocmVxdWVzdGVkRGF0YV90eXBlKSwg
MCkgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBw
ZXJyb3IoIkVycm9yIHNlbmRpbmcgcmVxdWVzdGVkIGRhdGEgdHlwZSIpOwogICAgICAgICAgICAg
ICAgICAgICAgICBleGl0KDEpOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAg
ICAgICAgcmVjZWl2ZV90aW1lc3RhbXAoc29ja2ZkKTsKICAgICAgICAgICAgICAgICAgICByZWNl
aXZlX2RldGVjdGlvbl9mcmFtZXMoc29ja2ZkKTsgfSk7CgogICAgLy8gQWRkIHRoZSBmaXJzdCBs
YXlvdXQgdG8gdGhlIG1haW4gbGF5b3V0CiAgICBsYXlvdXQtPmFkZExheW91dChsYXlvdXQxKTsK
CiAgICAvLyBDcmVhdGUgYSB2ZXJ0aWNhbCBsYXlvdXQgZm9yIHRoZSBzZWNvbmQgbWFpbiBidXR0
b24gYW5kIGl0cyBzdWItYnV0dG9ucwogICAgUVZCb3hMYXlvdXQgKmxheW91dDIgPSBuZXcgUVZC
b3hMYXlvdXQoKTsKICAgIFFQdXNoQnV0dG9uICpidXR0b24yID0gbmV3IFFQdXNoQnV0dG9uKCJT
ZW5kIENvbnRyb2wiLCBtYWluV2luZG93KTsKICAgIFFQdXNoQnV0dG9uICpidXR0b24yXzEgPSBu
ZXcgUVB1c2hCdXR0b24oIkNsb2NrIiwgbWFpbldpbmRvdyk7CiAgICBRUHVzaEJ1dHRvbiAqYnV0
dG9uMl8yID0gbmV3IFFQdXNoQnV0dG9uKCJQb3dlciIsIG1haW5XaW5kb3cpOwogICAgUVB1c2hC
dXR0b24gKmJ1dHRvbjJfMyA9IG5ldyBRUHVzaEJ1dHRvbigiVGVsZW1ldHJ5IiwgbWFpbldpbmRv
dyk7CiAgICBRUHVzaEJ1dHRvbiAqYnV0dG9uMl80ID0gbmV3IFFQdXNoQnV0dG9uKCJTeXN0ZW0g
U3RhdGVzIiwgbWFpbldpbmRvdyk7CiAgICBRUHVzaEJ1dHRvbiAqYnV0dG9uMl81ID0gbmV3IFFQ
dXNoQnV0dG9uKCJEZXRlY3RvcnMiLCBtYWluV2luZG93KTsKICAgIGxheW91dDItPmFkZFdpZGdl
dChidXR0b24yKTsKICAgIGxheW91dDItPmFkZFdpZGdldChidXR0b24yXzEpOwogICAgbGF5b3V0
Mi0+YWRkV2lkZ2V0KGJ1dHRvbjJfMik7CiAgICBsYXlvdXQyLT5hZGRXaWRnZXQoYnV0dG9uMl8z
KTsKICAgIGxheW91dDItPmFkZFdpZGdldChidXR0b24yXzQpOwogICAgbGF5b3V0Mi0+YWRkV2lk
Z2V0KGJ1dHRvbjJfNSk7CiAgICBsYXlvdXQyLT5zZXRTcGFjaW5nKDApOwogICAgbGF5b3V0Mi0+
c2V0Q29udGVudHNNYXJnaW5zKDAsIDAsIDAsIDApOwogICAgYnV0dG9uMl8xLT5oaWRlKCk7CiAg
ICBidXR0b24yXzItPmhpZGUoKTsKICAgIGJ1dHRvbjJfMy0+aGlkZSgpOwogICAgYnV0dG9uMl80
LT5oaWRlKCk7CiAgICBidXR0b24yXzUtPmhpZGUoKTsKCiAgICBRT2JqZWN0Ojpjb25uZWN0KGJ1
dHRvbjIsICZRUHVzaEJ1dHRvbjo6Y2xpY2tlZCwgWyZdKCkKICAgICAgICAgICAgICAgICAgICAg
ewogICAgICAgIHJlcXVlc3RfdHlwZSA9IFJlcXVlc3RUeXBlOjpTRU5EX0NPTlRST0w7CiAgICAg
ICAgLy8gU2VuZCByZXF1ZXN0IHR5cGUgdG8gc2VydmVyCiAgICAgICAgaWYgKHNlbmQoc29ja2Zk
LCAmcmVxdWVzdF90eXBlLCBzaXplb2YocmVxdWVzdF90eXBlKSwgMCkgPT0gLTEpCiAgICAgICAg
ewogICAgICAgICAgICBwZXJyb3IoIkVycm9yIHNlbmRpbmcgcmVxdWVzdCB0eXBlIik7CiAgICAg
ICAgICAgIGV4aXQoMSk7CiAgICAgICAgfQogICAgICAgIGJ1dHRvbjJfMS0+c2V0VmlzaWJsZSgh
YnV0dG9uMl8xLT5pc1Zpc2libGUoKSk7CiAgICAgICAgYnV0dG9uMl8yLT5zZXRWaXNpYmxlKCFi
dXR0b24yXzItPmlzVmlzaWJsZSgpKTsKICAgICAgICBidXR0b24yXzMtPnNldFZpc2libGUoIWJ1
dHRvbjJfMy0+aXNWaXNpYmxlKCkpOwogICAgICAgIGJ1dHRvbjJfNC0+c2V0VmlzaWJsZSghYnV0
dG9uMl80LT5pc1Zpc2libGUoKSk7CiAgICAgICAgYnV0dG9uMl81LT5zZXRWaXNpYmxlKCFidXR0
b24yXzUtPmlzVmlzaWJsZSgpKTsgfSk7CgogICAgLy8gQ29ubmVjdCB0aGUgY2xpY2tlZCgpIHNp
Z25hbCBvZiBidXR0b24xXzEgdG8gYSBjdXN0b20gc2xvdCB0aGF0IHByaW50cyBhIG1lc3NhZ2UK
ICAgIFFPYmplY3Q6OmNvbm5lY3QoYnV0dG9uMl8xLCAmUVB1c2hCdXR0b246OmNsaWNrZWQsIFsm
XSgpCiAgICAgICAgICAgICAgICAgICAgIHtzZW5kX0NvbnRyb2x0eXBlID0gU0VORF9DT05UUk9M
VHlwZTo6Q09OVFJPTF9DTE9DSzsKICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbmQoc29ja2Zk
LCAmc2VuZF9Db250cm9sdHlwZSwgc2l6ZW9mKHNlbmRfQ29udHJvbHR5cGUpLCAwKSA9PSAtMSkK
ICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVy
cm9yKCJFcnJvciBzZW5kaW5nIGNvbnRyb2wgdHlwZSIpOwogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZXhpdCgxKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
ICAgICAgICBzdHJpbmcgY29uZmlnX2ZpbGVfbmFtZSA9ICJjb25maWdGaWxlcy9DbG9jay5pbmki
OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY29uZmlnX2ZpbGVfbmFtZS5l
bXB0eSgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2VuZENvbmZpZ0ZpbGVVcGRhdGVzKGNvbmZpZ19maWxlX25h
bWUsIHNvY2tmZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSB9KTsKICAgIC8v
IENvbm5lY3QgdGhlIGNsaWNrZWQoKSBzaWduYWwgb2YgYnV0dG9uMV8xIHRvIGEgY3VzdG9tIHNs
b3QgdGhhdCBwcmludHMgYSBtZXNzYWdlCiAgICBRT2JqZWN0Ojpjb25uZWN0KGJ1dHRvbjJfMiwg
JlFQdXNoQnV0dG9uOjpjbGlja2VkLCBbJl0oKQogICAgICAgICAgICAgICAgICAgICB7c2VuZF9D
b250cm9sdHlwZSA9IFNFTkRfQ09OVFJPTFR5cGU6OkNPTlRST0xfUE9XRVI7CiAgICAgICAgICAg
ICAgICAgICAgIGlmIChzZW5kKHNvY2tmZCwgJnNlbmRfQ29udHJvbHR5cGUsIHNpemVvZihzZW5k
X0NvbnRyb2x0eXBlKSwgMCkgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHBlcnJvcigiRXJyb3Igc2VuZGluZyBjb250cm9sIHR5cGUi
KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4aXQoMSk7CiAgICAgICAgICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nIGNvbmZpZ19maWxlX25hbWUg
PSAiY29uZmlnRmlsZXMvUG93ZXIuaW5pIjsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaWYgKCFjb25maWdfZmlsZV9uYW1lLmVtcHR5KCkpCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kQ29uZmln
RmlsZVVwZGF0ZXMoY29uZmlnX2ZpbGVfbmFtZSwgc29ja2ZkKTsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB9IH0pOwogICAgLy8gQ29ubmVjdCB0aGUgY2xpY2tlZCgpIHNpZ25hbCBv
ZiBidXR0b24xXzEgdG8gYSBjdXN0b20gc2xvdCB0aGF0IHByaW50cyBhIG1lc3NhZ2UKICAgIFFP
YmplY3Q6OmNvbm5lY3QoYnV0dG9uMl8zLCAmUVB1c2hCdXR0b246OmNsaWNrZWQsIFsmXSgpCiAg
ICAgICAgICAgICAgICAgICAgIHtzZW5kX0NvbnRyb2x0eXBlID0gU0VORF9DT05UUk9MVHlwZTo6
Q09OVFJPTF9URUxFTUVUUlk7CiAgICAgICAgICAgICAgICAgICAgIGlmIChzZW5kKHNvY2tmZCwg
JnNlbmRfQ29udHJvbHR5cGUsIHNpemVvZihzZW5kX0NvbnRyb2x0eXBlKSwgMCkgPT0gLTEpCiAg
ICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnJv
cigiRXJyb3Igc2VuZGluZyB1cGRhdGUgdHlwZSIpOwogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZXhpdCgxKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg
ICAgICBzdHJpbmcgY29uZmlnX2ZpbGVfbmFtZSA9ICJjb25maWdGaWxlcy9UZWxlbWV0cnkuaW5p
IjsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb25maWdfZmlsZV9uYW1l
LmVtcHR5KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzZW5kQ29uZmlnRmlsZVVwZGF0ZXMoY29uZmlnX2ZpbGVf
bmFtZSwgc29ja2ZkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IH0pOwogICAg
Ly8gQ29ubmVjdCB0aGUgY2xpY2tlZCgpIHNpZ25hbCBvZiBidXR0b24xXzEgdG8gYSBjdXN0b20g
c2xvdCB0aGF0IHByaW50cyBhIG1lc3NhZ2UKICAgIC8vIENvbm5lY3QgdGhlIGNsaWNrZWQoKSBz
aWduYWwgb2YgYnV0dG9uMl80IHRvIGEgY3VzdG9tIHNsb3QgdGhhdCBwcmludHMgYSBtZXNzYWdl
CiAgICBRT2JqZWN0Ojpjb25uZWN0KGJ1dHRvbjJfNCwgJlFQdXNoQnV0dG9uOjpjbGlja2VkLCBb
Jl0oKQogICAgICAgICAgICAgICAgICAgICB7c2VuZF9Db250cm9sdHlwZSA9IFNFTkRfQ09OVFJP
TFR5cGU6OkNPTlRST0xfU1lTX1NUQVRFOwogICAgICAgICAgICAgICAgICAgICBpZiAoc2VuZChz
b2NrZmQsICZzZW5kX0NvbnRyb2x0eXBlLCBzaXplb2Yoc2VuZF9Db250cm9sdHlwZSksIDApID09
IC0xKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBwZXJyb3IoIkVycm9yIHNlbmRpbmcgdXBkYXRlIHR5cGUiKTsKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGV4aXQoMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg
ICAgICAgICBzdHJpbmcgY29uZmlnX2ZpbGVfbmFtZSA9ICJjb25maWdGaWxlcy9TeXN0ZW1TdGF0
ZS5pbmkiOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbmZpZ19maWxl
X25hbWUuZW1wdHkoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRDb25maWdGaWxlVXBkYXRlcyhjb25maWdf
ZmlsZV9uYW1lLCBzb2NrZmQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gfSk7
CiAgICAvLyBDb25uZWN0IHRoZSBjbGlja2VkKCkgc2lnbmFsIG9mIGJ1dHRvbjFfMSB0byBhIGN1
c3RvbSBzbG90IHRoYXQgcHJpbnRzIGEgbWVzc2FnZQogICAgUU9iamVjdDo6Y29ubmVjdChidXR0
b24yXzUsICZRUHVzaEJ1dHRvbjo6Y2xpY2tlZCwgWyZdKCkKICAgICAgICAgICAgICAgICAgICAg
e3NlbmRfQ29udHJvbHR5cGUgPSBTRU5EX0NPTlRST0xUeXBlOjpDT05UUk9MX0RFVEVDVE9SUzsK
ICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbmQoc29ja2ZkLCAmc2VuZF9Db250cm9sdHlwZSwg
c2l6ZW9mKHNlbmRfQ29udHJvbHR5cGUpLCAwKSA9PSAtMSkKICAgICAgICAgICAgICAgICAgICAg
ICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVycm9yKCJFcnJvciBzZW5kaW5nIHVw
ZGF0ZSB0eXBlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGl0KDEpOwogICAgICAg
ICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZyBjb25maWdf
ZmlsZV9uYW1lID0gImNvbmZpZ0ZpbGVzL1N1bnNwb3REZXRlY3Rpb24uaW5pIjsgCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb25maWdfZmlsZV9uYW1lLmVtcHR5KCkpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzZW5kQ29uZmlnRmlsZVVwZGF0ZXMoY29uZmlnX2ZpbGVfbmFtZSwgc29ja2Zk
KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IH0pOwoKICAgIC8vIEFkZCB0aGUg
c2Vjb25kIGxheW91dCB0byB0aGUgbWFpbiBsYXlvdXQKICAgIGxheW91dC0+YWRkTGF5b3V0KGxh
eW91dDIpOwoKICAgIFFWQm94TGF5b3V0ICpsYXlvdXQzID0gbmV3IFFWQm94TGF5b3V0KCk7CiAg
ICBRUHVzaEJ1dHRvbiAqYnV0dG9uMyA9IG5ldyBRUHVzaEJ1dHRvbigiUmVnaXN0ZXIgQ29udHJv
bCIsIG1haW5XaW5kb3cpOwogICAgUVB1c2hCdXR0b24gKmJ1dHRvbjNfMSA9IG5ldyBRUHVzaEJ1
dHRvbigiQ0xPQ0sgUmVnIiwgbWFpbldpbmRvdyk7CiAgICBRUHVzaEJ1dHRvbiAqYnV0dG9uM18y
ID0gbmV3IFFQdXNoQnV0dG9uKCJQT1dFUiBSZWciLCBtYWluV2luZG93KTsKICAgIFFQdXNoQnV0
dG9uICpidXR0b24zXzMgPSBuZXcgUVB1c2hCdXR0b24oIkNFIFJlZyIsIG1haW5XaW5kb3cpOwog
ICAgUVB1c2hCdXR0b24gKmJ1dHRvbjNfNCA9IG5ldyBRUHVzaEJ1dHRvbigiTExDIFJlZyIsIG1h
aW5XaW5kb3cpOwoKICAgIGxheW91dDMtPmFkZFdpZGdldChidXR0b24zKTsKICAgIGxheW91dDMt
PmFkZFdpZGdldChidXR0b24zXzEpOwogICAgbGF5b3V0My0+YWRkV2lkZ2V0KGJ1dHRvbjNfMik7
CiAgICBsYXlvdXQzLT5hZGRXaWRnZXQoYnV0dG9uM18zKTsKICAgIGxheW91dDMtPmFkZFdpZGdl
dChidXR0b24zXzQpOwogICAgbGF5b3V0My0+c2V0U3BhY2luZygwKTsKICAgIGxheW91dDMtPnNl
dENvbnRlbnRzTWFyZ2lucygwLCAwLCAwLCAwKTsKICAgIGJ1dHRvbjNfMS0+aGlkZSgpOwogICAg
YnV0dG9uM18yLT5oaWRlKCk7CiAgICBidXR0b24zXzMtPmhpZGUoKTsKICAgIGJ1dHRvbjNfNC0+
aGlkZSgpOwoKICAgIFFPYmplY3Q6OmNvbm5lY3QoYnV0dG9uMywgJlFQdXNoQnV0dG9uOjpjbGlj
a2VkLCBbJl0oKQogICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgcmVxdWVzdF90eXBlID0g
UmVxdWVzdFR5cGU6OlJlZ0NPTlRST0w7CiAgICAgICAgLy8gU2VuZCByZXF1ZXN0IHR5cGUgdG8g
c2VydmVyCiAgICAgICAgaWYgKHNlbmQoc29ja2ZkLCAmcmVxdWVzdF90eXBlLCBzaXplb2YocmVx
dWVzdF90eXBlKSwgMCkgPT0gLTEpCiAgICAgICAgewogICAgICAgICAgICBwZXJyb3IoIkVycm9y
IHNlbmRpbmcgcmVxdWVzdCB0eXBlIik7CiAgICAgICAgICAgIGV4aXQoMSk7CiAgICAgICAgfQog
ICAgICAgIGJ1dHRvbjNfMS0+c2V0VmlzaWJsZSghYnV0dG9uM18xLT5pc1Zpc2libGUoKSk7CiAg
ICAgICAgYnV0dG9uM18yLT5zZXRWaXNpYmxlKCFidXR0b24zXzItPmlzVmlzaWJsZSgpKTsKICAg
ICAgICBidXR0b24zXzMtPnNldFZpc2libGUoIWJ1dHRvbjNfMy0+aXNWaXNpYmxlKCkpOwogICAg
ICAgIGJ1dHRvbjNfNC0+c2V0VmlzaWJsZSghYnV0dG9uM180LT5pc1Zpc2libGUoKSk7IH0pOwoK
ICAgIC8vIENvbm5lY3QgdGhlIGNsaWNrZWQoKSBzaWduYWwgb2YgYnV0dG9uMV8xIHRvIGEgY3Vz
dG9tIHNsb3QgdGhhdCBwcmludHMgYSBtZXNzYWdlCiAgICBRT2JqZWN0Ojpjb25uZWN0KGJ1dHRv
bjNfMSwgJlFQdXNoQnV0dG9uOjpjbGlja2VkLCBbJl0oKQogICAgICAgICAgICAgICAgICAgICB7
Y29udHJvbF9yZWcgPSBSZWdDb250cm9sVHlwZTo6UmVnQ29udHJvbF9DTE9DSzsKICAgICAgICAg
ICAgICAgICAgICBpZiAoc2VuZChzb2NrZmQsICZjb250cm9sX3JlZywgc2l6ZW9mKGNvbnRyb2xf
cmVnKSwgMCkgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAg
ICAgICBwZXJyb3IoIkVycm9yIHNlbmRpbmcgY29udHJvbCB0eXBlIik7CiAgICAgICAgICAgICAg
ICAgICAgICAgIGV4aXQoMSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
ICAgIENvbnRyb2xSZWdpc3RlcnMoc29ja2ZkLCAiQ0xPQ0siKTsgfSk7CiAgICAvLyBDb25uZWN0
IHRoZSBjbGlja2VkKCkgc2lnbmFsIG9mIGJ1dHRvbjFfMSB0byBhIGN1c3RvbSBzbG90IHRoYXQg
cHJpbnRzIGEgbWVzc2FnZQogICAgUU9iamVjdDo6Y29ubmVjdChidXR0b24zXzIsICZRUHVzaEJ1
dHRvbjo6Y2xpY2tlZCwgWyZdKCkKICAgICAgICAgICAgICAgICAgICAge2NvbnRyb2xfcmVnID0g
UmVnQ29udHJvbFR5cGU6OlJlZ0NvbnRyb2xfUE9XRVI7IAogICAgICAgICAgICAgICAgICAgIGlm
IChzZW5kKHNvY2tmZCwgJmNvbnRyb2xfcmVnLCBzaXplb2YoY29udHJvbF9yZWcpLCAwKSA9PSAt
MSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnJvcigi
RXJyb3Igc2VuZGluZyBjb250cm9sIHR5cGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZXhp
dCgxKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgQ29udHJvbFJl
Z2lzdGVycyhzb2NrZmQsICJQT1dFUiIpOyB9KTsKICAgIC8vIENvbm5lY3QgdGhlIGNsaWNrZWQo
KSBzaWduYWwgb2YgYnV0dG9uMV8xIHRvIGEgY3VzdG9tIHNsb3QgdGhhdCBwcmludHMgYSBtZXNz
YWdlCiAgICBRT2JqZWN0Ojpjb25uZWN0KGJ1dHRvbjNfMywgJlFQdXNoQnV0dG9uOjpjbGlja2Vk
LCBbJl0oKQogICAgICAgICAgICAgICAgICAgICB7Y29udHJvbF9yZWcgPSBSZWdDb250cm9sVHlw
ZTo6UmVnQ29udHJvbF9DRTsKICAgICAgICAgICAgICAgICAgICBpZiAoc2VuZChzb2NrZmQsICZj
b250cm9sX3JlZywgc2l6ZW9mKGNvbnRyb2xfcmVnKSwgMCkgPT0gLTEpCiAgICAgICAgICAgICAg
ICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwZXJyb3IoIkVycm9yIHNlbmRpbmcgY29u
dHJvbCB0eXBlIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGV4aXQoMSk7CiAgICAgICAgICAg
ICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIENvbnRyb2xSZWdpc3RlcnMoc29ja2ZkLCAi
RW5jcnlwdGlvbiBDaGFubmVsIChFQykiKTsgfSk7CiAgICAvLyBDb25uZWN0IHRoZSBjbGlja2Vk
KCkgc2lnbmFsIG9mIGJ1dHRvbjFfMSB0byBhIGN1c3RvbSBzbG90IHRoYXQgcHJpbnRzIGEgbWVz
c2FnZQogICAgUU9iamVjdDo6Y29ubmVjdChidXR0b24zXzQsICZRUHVzaEJ1dHRvbjo6Y2xpY2tl
ZCwgWyZdKCkKICAgICAgICAgICAgICAgICAgICAge2NvbnRyb2xfcmVnID0gUmVnQ29udHJvbFR5
cGU6OlJlZ0NvbnRyb2xfTExDOwogICAgICAgICAgICAgICAgICAgIGlmIChzZW5kKHNvY2tmZCwg
JmNvbnRyb2xfcmVnLCBzaXplb2YoY29udHJvbF9yZWcpLCAwKSA9PSAtMSkKICAgICAgICAgICAg
ICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnJvcigiRXJyb3Igc2VuZGluZyBj
b250cm9sIHR5cGUiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZXhpdCgxKTsKICAgICAgICAg
ICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgQ29udHJvbFJlZ2lzdGVycyhzb2NrZmQs
ICJMTEMiKTsKICAgICAgICAgICAgICAgICAgICAvKnFEZWJ1ZygpIDw8ICJMSUxMSUFOIENvbnRy
b2wgcGFyYW1ldGVycyBjb250cm9sIGJ1dHRvbiBwcmVzc2VkIjsqLyB9KTsKCiAgICAvLyBBZGQg
dGhlIHRoaXJkIGxheW91dCB0byB0aGUgbWFpbiBsYXlvdXQKICAgIGxheW91dC0+YWRkTGF5b3V0
KGxheW91dDMpOwoKICAgIC8vIFNldCB0aGUgYmFja2dyb3VuZCBjb2xvciBvZiB0aGUgZmlyc3Qg
bWFpbiBidXR0b24gdG8gYmx1ZQogICAgYnV0dG9uMS0+c2V0U3R5bGVTaGVldCgiYmFja2dyb3Vu
ZC1jb2xvcjogRGFya0N5YW47Iik7CgogICAgLy8gU2V0IHRoZSBiYWNrZ3JvdW5kIGNvbG9yIG9m
IHRoZSBzZWNvbmQgbWFpbiBidXR0b24gdG8gZ3JlZW4KICAgIGJ1dHRvbjItPnNldFN0eWxlU2hl
ZXQoImJhY2tncm91bmQtY29sb3I6IERhcmtDeWFuOyIpOwoKICAgIC8vIFNldCB0aGUgYmFja2dy
b3VuZCBjb2xvciBvZiB0aGUgc2Vjb25kIG1haW4gYnV0dG9uIHRvIGdyZWVuCiAgICBidXR0b24z
LT5zZXRTdHlsZVNoZWV0KCJiYWNrZ3JvdW5kLWNvbG9yOiAgRGFya0N5YW47Iik7CgogICAgLy8g
U2V0IHRoZSBiYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSBzdWItYnV0dG9ucyB0byBncmF5CiAgICBi
dXR0b24xXzEtPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24xXzItPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24xXzMtPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24yXzEtPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24yXzItPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24yXzMtPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24yXzQtPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24yXzUtPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24zXzEtPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24zXzItPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24zXzMtPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CiAgICBi
dXR0b24zXzQtPnNldFN0eWxlU2hlZXQoImJhY2tncm91bmQtY29sb3I6IGdyYXk7Iik7CgogICAg
Ly8gQ3JlYXRlIGEgbGFiZWwgZm9yIHRoZSBpbWFnZSBhcmVhCiAgICBRTGFiZWwgKmltYWdlTGFi
ZWwgPSBuZXcgUUxhYmVsKG1haW5XaW5kb3cpOwoKICAgIC8vIExvYWQgdGhlIGRlZmF1bHQgaW1h
Z2UgYW5kIHNldCBpdCB0byB0aGUgaW1hZ2UgbGFiZWwKICAgIFFQaXhtYXAgZGVmYXVsdEltYWdl
KCJkZWZhdWx0LmpwZyIpOwogICAgaW1hZ2VMYWJlbC0+c2V0UGl4bWFwKGRlZmF1bHRJbWFnZSk7
CiAgICAvLyBDcmVhdGUgYSB0YWJsZSB3aWRnZXQKICAgIFFUYWJsZVdpZGdldCAqdGFibGVXaWRn
ZXQgPSBuZXcgUVRhYmxlV2lkZ2V0KG1haW5XaW5kb3cpOwoKICAgIC8vIE9wZW4gdGhlIENTViBm
aWxlCiAgICBRRmlsZSBmaWxlKCJyZWNlaXZlZF9kZXRlY3Rpb25zLmNzdiIpOwogICAgaWYgKCFm
aWxlLm9wZW4oUUlPRGV2aWNlOjpSZWFkT25seSB8IFFJT0RldmljZTo6VGV4dCkpCiAgICAgICAg
cmV0dXJuIC0xOwoKICAgIC8vIFJlYWQgdGhlIGNvbnRlbnRzIG9mIHRoZSBDU1YgZmlsZQogICAg
UVRleHRTdHJlYW0gaW4oJmZpbGUpOwogICAgaW50IHJvdyA9IDA7CiAgICB3aGlsZSAoIWluLmF0
RW5kKCkpCiAgICB7CiAgICAgICAgUVN0cmluZyBsaW5lID0gaW4ucmVhZExpbmUoKTsKICAgICAg
ICBRU3RyaW5nTGlzdCBmaWVsZHMgPSBsaW5lLnNwbGl0KCIsIik7CiAgICAgICAgaWYgKHJvdyA9
PSAwKQogICAgICAgIHsKICAgICAgICAgICAgLy8gU2V0IHRoZSBudW1iZXIgb2YgY29sdW1ucyBp
biB0aGUgdGFibGUKICAgICAgICAgICAgdGFibGVXaWRnZXQtPnNldENvbHVtbkNvdW50KGZpZWxk
cy5zaXplKCkpOwoKICAgICAgICAgICAgLy8gU2V0IHRoZSBjb2x1bW4gaGVhZGVycwogICAgICAg
ICAgICBRU3RyaW5nTGlzdCBoZWFkZXJzOwogICAgICAgICAgICBmb3JlYWNoIChjb25zdCBRU3Ry
aW5nJiBmaWVsZCwgZmllbGRzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBoZWFkZXJz
IDw8IGZpZWxkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRhYmxlV2lkZ2V0LT5zZXRIb3Jp
em9udGFsSGVhZGVyTGFiZWxzKGhlYWRlcnMpOwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAg
ICAgewogICAgICAgICAgICAvLyBBZGQgYSBuZXcgcm93IHRvIHRoZSB0YWJsZQogICAgICAgICAg
ICB0YWJsZVdpZGdldC0+aW5zZXJ0Um93KHRhYmxlV2lkZ2V0LT5yb3dDb3VudCgpKTsKCiAgICAg
ICAgICAgIC8vIFNldCB0aGUgdmFsdWVzIGZvciBlYWNoIGNvbHVtbiBpbiB0aGUgcm93CiAgICAg
ICAgICAgIGludCBjb2x1bW4gPSAwOwogICAgICAgICAgICBmb3JlYWNoIChjb25zdCBRU3RyaW5n
JiBmaWVsZCwgZmllbGRzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBRVGFibGVXaWRn
ZXRJdGVtICppdGVtID0gbmV3IFFUYWJsZVdpZGdldEl0ZW0oZmllbGQpOwogICAgICAgICAgICAg
ICAgdGFibGVXaWRnZXQtPnNldEl0ZW0ocm93LTEsIGNvbHVtbiwgaXRlbSk7CiAgICAgICAgICAg
ICAgICBjb2x1bW4rKzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByb3crKzsKICAg
IH0KCiAgICAvLyBDbG9zZSB0aGUgQ1NWIGZpbGUKICAgIGZpbGUuY2xvc2UoKTsKCiAgICAvLyBT
ZXQgdGhlIHNpemUgb2YgdGhlIHRhYmxlIHdpZGdldAogICAgdGFibGVXaWRnZXQtPnJlc2l6ZUNv
bHVtbnNUb0NvbnRlbnRzKCk7CiAgICB0YWJsZVdpZGdldC0+c2V0U2l6ZVBvbGljeShRU2l6ZVBv
bGljeTo6RXhwYW5kaW5nLCBRU2l6ZVBvbGljeTo6RXhwYW5kaW5nKTsKCiAgICAvLyBDcmVhdGUg
YSBsYWJlbCBmb3IgdGhlIHNsaWRlcnMgdGl0bGUKICAgIFFMYWJlbCAqc2xpZGVyc0xhYmVsID0g
bmV3IFFMYWJlbCgiTElMTElBTiBDb250cm9scyIsIG1haW5XaW5kb3cpOwogICAgc2xpZGVyc0xh
YmVsLT5zZXRBbGlnbm1lbnQoUXQ6OkFsaWduQ2VudGVyKTsKICAgIC8vIFNldCB0aGUgYmFja2dy
b3VuZCBjb2xvciBvZiB0aGUgdGV4dAogICAgc2xpZGVyc0xhYmVsLT5zZXRTdHlsZVNoZWV0KCJi
YWNrZ3JvdW5kLWNvbG9yOiBsaWdodEdyYXk7Iik7CgogICAgLy8gQWRkIHRoZSBzbGlkZXJzIHRp
dGxlIGxhYmVsIHRvIHRoZSBsYXlvdXQKICAgIGxheW91dC0+YWRkV2lkZ2V0KHNsaWRlcnNMYWJl
bCk7CgogICAgLy8gQ3JlYXRlIHRocmVlIHNsaWRlcnMgd2l0aCBsYWJlbHMKICAgIFFMYWJlbCAq
bGFiZWwxID0gbmV3IFFMYWJlbCgiVGhfZGV0ZWN0b3I6IDAlIiwgbWFpbldpbmRvdyk7CiAgICBR
U2xpZGVyICpzbGlkZXIxID0gbmV3IFFTbGlkZXIoUXQ6Okhvcml6b250YWwsIG1haW5XaW5kb3cp
OwogICAgUUxhYmVsICpsYWJlbDIgPSBuZXcgUUxhYmVsKCJUaF9hdXRvbGFiZWxlcjogMCUiLCBt
YWluV2luZG93KTsKICAgIFFTbGlkZXIgKnNsaWRlcjIgPSBuZXcgUVNsaWRlcihRdDo6SG9yaXpv
bnRhbCwgbWFpbldpbmRvdyk7CiAgICBRTGFiZWwgKmxhYmVsMyA9IG5ldyBRTGFiZWwoIkJhdGNo
IFNpemU6IDAlIiwgbWFpbldpbmRvdyk7CiAgICBRU2xpZGVyICpzbGlkZXIzID0gbmV3IFFTbGlk
ZXIoUXQ6Okhvcml6b250YWwsIG1haW5XaW5kb3cpOwoKICAgIC8vIEFkZCB0aGUgc2xpZGVycyBh
bmQgbGFiZWxzIHRvIHRoZSBsYXlvdXQKICAgIGxheW91dC0+YWRkV2lkZ2V0KGxhYmVsMSk7CiAg
ICBsYXlvdXQtPmFkZFdpZGdldChzbGlkZXIxKTsKICAgIGxheW91dC0+YWRkV2lkZ2V0KGxhYmVs
Mik7CiAgICBsYXlvdXQtPmFkZFdpZGdldChzbGlkZXIyKTsKICAgIGxheW91dC0+YWRkV2lkZ2V0
KGxhYmVsMyk7CiAgICBsYXlvdXQtPmFkZFdpZGdldChzbGlkZXIzKTsKCiAgICAvLyBBZGQgdHRh
YmxlIHRvIHRoZSBsYXlvdXQKICAgIGxheW91dC0+YWRkV2lkZ2V0KHRhYmxlV2lkZ2V0KTsKCiAg
ICAvLyBBZGQgdGhlIGltYWdlIHRvIHRoZSBsYXlvdXQgYXQgdGhlIGJvdHRvbQogICAgbGF5b3V0
LT5hZGRXaWRnZXQoaW1hZ2VMYWJlbCwgMSwgUXQ6OkFsaWduQ2VudGVyKTsKCiAgICAvLyBDb25u
ZWN0IHRoZSB2YWx1ZUNoYW5nZWQoaW50KSBzaWduYWxzIG9mIHRoZSBzbGlkZXJzIHRvIGN1c3Rv
bSBzbG90cyB0aGF0IHVwZGF0ZSB0aGUgY29ycmVzcG9uZGluZyBsYWJlbCB3aXRoIHRoZSBwZXJj
ZW50YWdlIHZhbHVlCiAgICBRT2JqZWN0Ojpjb25uZWN0KHNsaWRlcjEsICZRU2xpZGVyOjp2YWx1
ZUNoYW5nZWQsIFsmXShpbnQgdmFsdWUpCiAgICAgICAgICAgICAgICAgICAgIHsgbGFiZWwxLT5z
ZXRUZXh0KFFTdHJpbmcoIlRoX2RldGVjdG9yOiAlMSUiKS5hcmcodmFsdWUpKTsgfSk7CiAgICBR
T2JqZWN0Ojpjb25uZWN0KHNsaWRlcjIsICZRU2xpZGVyOjp2YWx1ZUNoYW5nZWQsIFsmXShpbnQg
dmFsdWUpCiAgICAgICAgICAgICAgICAgICAgIHsgbGFiZWwyLT5zZXRUZXh0KFFTdHJpbmcoIlRo
X2F1dG9sYWJlbGVyOiAlMSUiKS5hcmcodmFsdWUpKTsgfSk7CiAgICBRT2JqZWN0Ojpjb25uZWN0
KHNsaWRlcjMsICZRU2xpZGVyOjp2YWx1ZUNoYW5nZWQsIFsmXShpbnQgdmFsdWUpCiAgICAgICAg
ICAgICAgICAgICAgIHsgbGFiZWwzLT5zZXRUZXh0KFFTdHJpbmcoIkJhdGNoIFNpemU6ICUxJSIp
LmFyZyh2YWx1ZSkpOyB9KTsKCiAgICAvLyBTaG93IHRoZSBtYWluIHdpbmRvdyB3aWRnZXQKICAg
IG1haW5XaW5kb3ctPnNob3coKTsKICAgIHJldHVybiBhLmV4ZWMoKTsKICAgIC8vIENsb3NlIHRo
ZSBzb2NrZXQKICAgIGNsb3NlKHNvY2tmZCk7Cn0=
--000000000000a4958405f9863196--
